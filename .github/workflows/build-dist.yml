name: Build dist branch

on:
  push:
    branches: [main]
  workflow_dispatch:
    inputs:
      source_ref:
        description: 'Source ref to build from (default: main)'
        required: false
        default: 'main'

permissions:
  contents: write

jobs:
  build-dist:
    runs-on: ubuntu-latest
    steps:
      - uses: runsascoded/npm-dist@v1
        with:
          source_ref: ${{ inputs.source_ref || 'main' }}
          build_command: pnpm run build
          pkgs: |
            packages/client
            packages/parser
            packages/slidev
            packages/types
